{% extends 'base_settings.html' %}

{% block title %}Moje Finanse{% endblock %}

{% block style %}

    <!-- Bootstrap core CSS -->
	<link href="/bootstrap-4.0.0-dist/css/bootstrap.css" rel="stylesheet">
	<!-- Report Style CSS -->
	<link href="/css/application_settings_style.css" rel="stylesheet">
	<link href="/bootstrap-4.0.0-dist/css/dashboard.css" rel="stylesheet">
	<!--Dodatkowe Fonty -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	
	<!-- Google Fonts Roboto -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
	<!-- Bootstrap core CSS -->
	<!--<link rel="stylesheet" href="/css/bootstrap.min.css"> -->
	
	<!-- MDBootstrap Datatables  -->
	<link href="/css/addons/datatables.min.css" rel="stylesheet">
	<!-- MDBootstrap Datatables2  -->
	<link href="/css/addons/datatables2.min.css" rel="stylesheet">

	<!-- Material Design Bootstrap -->
	<link rel="stylesheet" href="/css/mdb.min.css">
	<!-- Your custom styles (optional) -->
	<link rel="stylesheet" href="/css/style.css">

{% endblock %}

{% block body %} 

	<!-- passing option value to JS-->
	<script>
		var $option = {{ option }};
	</script> 


<!-- Finance Manager Content-->
<div class="container-fluid bg pt-0 mainWindow">	
	<div class="row d-flex justify-content-center">	
				
		
		
	<!--Section: Block Content-->
		<div id="feedbackLine" class="row d-flex justify-content-center w-100"><div id="feedback" class="alert text-center" role="alert"></div></div>
		
		<section class="mb-5 text-center bg-light">

		  <p>Zmień hasło</p>

		  <form id="passwordChange" action="/Settings/changePassword">

			<div class="md-form md-outline">
			  <input type="password" id="newPass" class="form-control">
			  <label data-error="wrong" data-success="right" for="newPass">New password</label>
			</div>

			<div class="md-form md-outline">
			  <input type="password" id="newPassConfirm" class="form-control">
			  <label data-error="wrong" data-success="right" for="newPassConfirm">Confirm password</label>
			</div>

			<button type="submit" class="btn btn-primary mb-4">Zmień</button>

		  </form>

		  <div class="d-flex justify-content-between align-items-center mb-2">
			<div class="alert alert-danger" role="alert">
			  {{ userData.errors['error_password'] }}
			</div>
		  </div>

		</section>
	<!--Section: Block Content-->
		
		
		
		
	</div>
	
</div><!-- /.container-fluid-->

	
	<!-- jQuery -->
	<script type="text/javascript" src="/js/jquery.min.js"></script>
	<!-- Bootstrap tooltips -->
	<script type="text/javascript" src="/js/popper.min.js"></script>
	<!-- Bootstrap core JavaScript -->
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>
	<!-- MDB core JavaScript -->
	<script type="text/javascript" src="/js/mdb.min.js"></script>
	<!-- Your custom scripts (optional) -->
	<script type="text/javascript"></script>
	<!-- MDBootstrap Datatables  -->
	<script type="text/javascript" src="/js/addons/datatables.min.js"></script>
	<!-- MDBootstrap Datatables2  -->
	<script type="text/javascript" src="/js/addons/datatables2.min.js"></script>
	<!-- Script for Income Categories Table  -->
	<script type="text/javascript" src="/js/incomeCategoriesTable.js" charset="utf-8"></script>

	<!-- Script for Income Categories Table  -->
	<script type="text/javascript" src="/js/incomeCategoriesTable.js" charset="utf-8"></script>



	<script>
	$(document).ready(function(){
		$("#passwordChange").on("submit", function(event){
			event.preventDefault();
			var $newPassword1 = $('#newPass ').val();
			var $newPassword2 = $('#newPassConfirm').val();
			$.ajax({
				type: 'POST',
				url: '/Settings/changePassword',
				data: {
					newPassword1: $newPassword1,
					newPassword2: $newPassword2
					},
				success: function(res, msg) {
				  res = $.parseJSON(res);
				  if (!res.passwrodsAreIdentical) {					
					$("#feedback").show().text(res.message).removeClass('alert-danger').addClass('alert-success').delay(3000).queue(function(n) {$(this).hide(); n();});
				  }
				  else
				  {
					$("#feedback").show().text(res.message).removeClass('alert-success').addClass('alert-danger').delay(3000).queue(function(n) {$(this).hide(); n();});					
				  };
				},
				error : function() {
					console.log("Wystąpił błąd z połączeniem");
				}
			});
		});
	});
	</script>	
	
	<!-- feather icons  -->
	<script>feather.replace()</script>
	<!-- End of feather icons  -->
{% endblock %}